pre-config:
  commands:
    - "target remote :11111"
    - "set pagination off"
config:
  timeout: 240
  collect:
    - name: "handling_model_torque_curve"
      points:
        - locspec: "*0x004fdac0"
          values:
            - name: "rpm"
              expr: "$edx"
              format: "%u"
        - locspec: "*0x004fdbec"
          values:
            - &result_st0
              name: "result"
              expr: "$st0"
              format: "%f"
    - name: "something_with_ang_vel"
      points:
        - locspec: "*0x00502f0c"
          values:
            - &local_linear_velocity_x
              name: "linear_velocity_x"
              expr: "*((float*)($eax + 0x434))"
              format: "%f"
            - &local_linear_velocity_y
              name: "linear_velocity_y"
              expr: "*((float*)($eax + 0x438))"
              format: "%f"
            - &local_linear_velocity_z
              name: "linear_velocity_z"
              expr: "*((float*)($eax + 0x43c))"
              format: "%f"
            - &global_angular_velocity_y
              name: "angular_velocity_y"
              expr: "*((float*)($eax + 0x5c))"
              format: "%f"
            - &current_gear
              name: "gear"
              expr: "*((uint8_t*)($eax + 0x453))"
              format: "%u"
            - &inertia_inv_y
              name: "inertia_inv_y"
              expr: "*((float*)($eax + 0x74))"
              format: "%f"
            - &mass
              name: "mass"
              expr: "*((float*)($eax + 0x20))"
              format: "%f"
        - locspec: "*0x00502f31"
          values:
            - *result_st0
    - name: "steering_angle"
      points:
        - locspec: "*0x005014e0"
          values:
            - *local_linear_velocity_x
            - *local_linear_velocity_y
            - *local_linear_velocity_z
            - &turn_angle
              name: "turn_angle"
              expr: "*((uint32_t*)($eax + 0x464))"
              format: "%d"
            - &handbrake
              name: "handbrake"
              expr: "*((uint8_t*)($eax + 0x455))"
              format: "%u"
        - locspec: "*0x005017aa"
          values:
            - *result_st0
    - name: "traction_drag"
      points:
        - locspec: "*0x004ffb2e"
          values:
            - *local_linear_velocity_x
            - *local_linear_velocity_y
            - *local_linear_velocity_z
        - locspec: "*0x004ffbba"
          values:
            - name: "result"
              expr: "*((float*)($ebp - 0x20))"
              format: "%f"
post-config:
  commands:
    - "continue"
